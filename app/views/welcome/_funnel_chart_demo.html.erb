<div class = "funnel-chart-demo demo container">
  <div class = "demo-ind">
    <div class = "demo-toggle start"></div>
    <div class = "demo-message">Funnel Chart</div>
  </div>
  <div class = "chart" style = "max-width: 500px;"></div>
</div>
<script>
  (function(){
    var id = "funnel-chart";

    var chartContainer = d3.select('.'+id+'-demo .chart');

    var chart = d2b.CHARTS.funnelChart().select('.'+id+'-demo .chart');

    var currentSlide = 0;

    var interval;

    function resize(){
      var width = chartContainer.node().getBoundingClientRect().width;
      chart
        .width(width)
        .height(500)
        .animationDuration(500);
    }

    $('.'+id+'-demo .demo-toggle').click(function(){
      var button = $(this);

      if(button.hasClass("start")) interval = setInterval(switchSlides, 2000);
      else clearInterval(interval);

      button.toggleClass("start");
      button.toggleClass("stop");
    });

    $(window).on('resize.'+id+'-demo', function(){
      resize();
      chart.animationDuration(0).update().animationDuration(500)
    });
    resize();

    function rand(){
      return Math.round(Math.random() * 10000) + 5000;
    }

    function switchSlides(){

      var data = {
  			data:{
  				values:[
  					{label:'Segment A',value:rand(), pinched:true, note:'Here is a note about segment A.'},
  					{label:'Segment B',value:rand(), pinched:true, note:'Here is a note about segment B.'},
  					{label:'Segment C',value:rand(), pinched:true, note:'Here is a note about segment C.'},
  					{label:'Segment D',value:rand(), pinched:false, note:'Here is a note about segment D.'},
				  ]
  			}
  		};

      chart
        // .donutRatio(Math.random() * 0.8)
        .data(data)
        // .controls({hideLegend:{enabled:true}})
        .update();
    }

    switchSlides();

  })();
</script>
