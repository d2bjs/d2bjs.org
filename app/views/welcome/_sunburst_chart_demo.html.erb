<div class = "sunburst-chart-demo demo container">
  <div class = "demo-ind">
    <div class = "demo-toggle start"></div>
    <div class = "demo-message">Sunburst</div>
  </div>
  <div class = "chart"></div>
</div>
<script>
  (function(){
    var id = "sunburst-chart";

    var chartContainer = d3.select('.'+id+'-demo .chart');

    var chart = d2b.CHARTS.sunburstChart().select('.'+id+'-demo .chart');

    var currentSlide = 0;

    var interval;

    var data = {
      data:{
        partition:{
          name: "A",
          children: [
            {
              name: "AA",
              top: true,
              children: [
                {
                  name: "AAA"
                },
                {
                  name: "AAB"
                },
                {
                  name: "AAC"
                },
                {
                  name: "AAD",
                  children: [
                    {
                      name: "AADA"
                    },
                    {
                      name: "AADB"
                    }
                  ]
                }
              ]
            },
            {
              name: "AB",
              top: true,
              children: [
                {
                  name: "ABA"
                },
                {
                  name: "ABB",
                  children: [
                    {
                      name: "ABBA"
                    },
                    {
                      name: "ABBB"
                    },
                    {
                      name: "ABBC"
                    }
                  ]
                },
                {
                  name: "ABC"
                },
                {
                  name: "ABD"
                }
              ]
            },
            {
              name: "AC",
              top: true,
              children: [
                {
                  name: "ACA"
                },
                {
                  name: "ACB"
                }
              ]
            },
            {
              name: "AD",
              top: true
            },
            {
              name: "AE",
              top: true
            },
            {
              name: "AF",
              top: true
            }
          ]
        }
      }
    };

    function resize(){
      var width = chartContainer.node().getBoundingClientRect().width;
      chart
        .width(width)
        .height(600)
        .animationDuration(500);
    }

    $('.'+id+'-demo .demo-toggle').click(function(){
      var button = $(this);

      if(button.hasClass("start")) interval = setInterval(switchSlides, 2000);
      else clearInterval(interval);

      button.toggleClass("start");
      button.toggleClass("stop");
    });

    $(window).on('resize.'+id+'-demo', function(){
      resize();
      chart.animationDuration(0).update().animationDuration(500)
    });
    resize();

    function rand(){
      return Math.round(Math.random() * 100);
    }
    function randomize(cell){
      if(cell.children) cell.children.forEach(randomize);
      else cell.size = rand();
    }

    function switchSlides(){
      // var inverted = (Math.random() > 0.8)? false: true;
      randomize(data.data.partition);

      chart
        .data(data)
        .controls({hideLegend:{enabled:true}})
        // .controls({invert:{enabled:inverted}})
        .update();
    }

    switchSlides();

  })();
</script>
